# [Platinum I] 트리의 팔 - 26161 

[문제 링크](https://www.acmicpc.net/problem/26161) 

### 성능 요약

메모리: 64136 KB, 시간: 1140 ms

### 분류

깊이 우선 탐색, 고속 푸리에 변환, 그래프 이론, 그래프 탐색, 수학, 누적 합, 트리

### 문제 설명

<p>트리에 팔을 만들어주자.</p>

<p>트리의 팔을 다음과 같이 정의하자.</p>

<ul>
	<li>임의의 트리 $T$에 대해 트리의 양팔은 루트 노드 $R$에서 도달 가능한 리프노드 $a$, $b$ 한 쌍을 의미한다. 즉, 트리의 양팔은 리프노드 순서쌍 $(a, b)$이다.</li>
	<li>트리의 양팔이 $(a, b)$일 때, 왼쪽 팔은 $a$이고 오른쪽 팔은 $b$이다. </li>
	<li><strong>오른팔과 왼팔은 같을 수 있다. 즉, $(a, a)$도 유효한 양팔이다.</strong></li>
	<li>이때, 어떤 한쪽 팔의 길이는 루트 노드 $R$에서부터의 최단 거리로 정의한다.</li>
</ul>

<p>어떤 트리 $T$가 주어졌을 때, 해당 트리가 가질 수 있는 양팔을 $(a, b)$라고 했을 때, 양팔의 길이의 합이 $W$이상 $V$이하가 되는 순서쌍 $(a, b)$의 개수를 구하는 $Q$개의 쿼리를 처리해보자.</p>

### 입력 

 <p>첫 번째 줄에 트리의 정점 개수 $N$, 루트 노드의 번호 $R$이 주어진다. $(2 \le N \le 300\ 000; 1 \le R \le N)$</p>

<p>두 번째 줄부터 $N - 1$개의 줄에 걸쳐 연결된 두 정점 $u, v$가 공백으로 구분되어 주어진다. $(1 \le u, v \le N)$</p>

<p>$N + 2$ 번째 줄에는 처리해야할 쿼리의 개수 $Q$가 주어진다. $(1 \le Q \le 200\ 000)$</p>

<p>$N + 3$ 번째 줄부터 한 줄에 쿼리가 하나씩 주어진다. 각 쿼리의 $W, V$가 공백으로 구분되어 들어오는 형태이다. $(1 \le W \le V \le N)$</p>

### 출력 

 <p>양팔의 길이 합이 $W$이상 $V$이하가 되는 순서쌍 $(a, b)$의 개수를 구해 $1\ 000\ 000\ 007$로 나눈 나머지를 쿼리별로 한 줄마다 출력한다.</p>


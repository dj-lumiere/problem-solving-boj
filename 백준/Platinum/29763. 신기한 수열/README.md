# [Platinum V] 신기한 수열 - 29763 

[문제 링크](https://www.acmicpc.net/problem/29763) 

### 성능 요약

메모리: 153972 KB, 시간: 416 ms

### 분류

조합론, 분할 정복을 이용한 거듭제곱, 페르마의 소정리, 기댓값의 선형성, 수학, 모듈로 곱셈 역원, 정수론, 확률론

### 제출 일자

2024년 10월 14일 11:07:07

### 문제 설명

<p>길이 $N$의 정수열 $A$의 모든 원소를 Bitwise XOR한 값이 $X$일 때 $A$를 <strong>신기한 수열</strong>이라고 한다. $(0 \leq A_i < 2^M)$</p>

<p>가능한 모든 길이 $N$의 신기한 수열 중에서 균등한 확률로 수열 $A$를 골랐을 때 $\sum_{i=1}^{N}{ A_i }$의 기댓값을 구해보자.</p>

### 입력 

 <p>첫째 줄에 $N$, $M$이 공백으로 구분되어 주어진다. $(1 \leq N \leq 10^{18};$ $1 \leq M \leq 200\,000)$</p>

<p>둘째 줄에 $X$가 부호 없는 $M$자리 이진수 형태로 주어진다. </p>

### 출력 

 <p>$\sum_{i=1}^{N}{A_i}$의 기댓값을 소수 $10^9+7(=1\,000\,000\,007)$로 나눈 나머지를 출력한다.</p>

<p>서로소인 두 양의 정수 $a, b$에 대해 유리수 $\frac{b}{a}$를 $10^9+7$으로 나눈 나머지란, $a \times x \equiv b \pmod{10^9+7}$이며 $10^9+7$ 미만인 음이 아닌 정수 $x$를 의미한다.</p>

<p>가능한 모든 입력에 대해 그러한 $x$가 존재하며 유일함을 증명할 수 있다.</p>

